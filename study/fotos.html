<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AluraPic</title>
  <!-- Bootstrap 5 CDN -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
</head>

<!-- Vue.js app content -->
<script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>

<body class="bg-light py-5">
  <div id='app' class="container mt-4">
    <h1 class="text-center">{{titulo}}</h1>
    <form @submit.prevent="adicionarNome">
      <div class="mb-3">
        <label for="nome" class="form-label">Nome</label>
        <input type="text" @input="nome = $event.target.value" class="form-control" id="nome" v-model="nome"
          placeholder="Digite algo..." />
        {{nome}}
      </div>

      <div class="mb-3">
        <label class="form-label">Lists</label>
        <ul class="list-group list-group-flush">
          <li class="list-group-item" v-for="data in listNome" :key="data">
            {{data}}
        </ul>
      </div>

      <button type="submit" class="btn btn-primary">Enviar</button>
    </form>

    <div class="card mt-4">
      <div class="card-header bg-primary text-white text-center">Fotos Dog</div>
      <div class="card-body">
        <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 g-4">
          <div class="col" v-for="data in filterFotos" :key="data.id">
            <div class="card h-100 shadow-sm">
              <div class="card-body d-flex flex-column">
                <h5 class="card-title text-center"
                    @click="hideFotos(data)">{{ data.titulo }}</h5>
              </div>
              <div class="card-footer" v-show="data.visivel">
                <img :src="data.url" 
                     :alt="data.titulo" 
                     class="card-img-top object-fit-cover"
                     style="height: 200px; object-fit: cover;">              
              </div>       
            </div>
          </div>
        </div>
      </div>
    </div>

  </div>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <!-- Vue 3 CDN -->
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>

  <script>
    const {
      createApp
    } = Vue;

    createApp({

      data() {
        return {
          titulo: 'AluraPic',
          nome: '',
          listNome: [],
          listFotos: []

        }
      },

      created() {
        fetch('http://localhost:3000/v1/fotos')
          .then(response => response.json())
          .then(data => {
            this.listFotos = data.map(foto => ({
              ...foto,
              visivel: true
            }))
          }).catch(error => {
            console.error('Erro ao buscar fotos:', error);
          });
      },

      computed: {
        filterFotos() {
          if (this.nome) {
            return this.listFotos.filter(foto => {
              return foto.titulo.toLowerCase().includes(this.nome.toLowerCase())
            })
          }
          return this.listFotos
        }
      },

      methods: {
        adicionarNome() {
          this.listNome.push(this.nome);
          this.nome = ''
        },

        hideFotos(foto) {
          foto.visivel = !foto.visivel;
        }

      }

    }).mount('#app');
  </script>
</body>

</html>